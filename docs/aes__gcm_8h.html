<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libzpc: zpc/aes_gcm.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">libzpc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">IBM Z Protected-key Crypto library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f917d4082cd055ef81802047648c24.html">zpc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">aes_gcm.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>AES-GCM API.  
<a href="#details">More...</a></p>

<p><a href="aes__gcm_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa92ee7ddc9889b2b25b59e761cc294a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#aa92ee7ddc9889b2b25b59e761cc294a3">zpc_aes_gcm_alloc</a> (struct zpc_aes_gcm **ctx)</td></tr>
<tr class="separator:aa92ee7ddc9889b2b25b59e761cc294a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a569a6d59a6e7f4f59245168cc1a7f6af"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#a569a6d59a6e7f4f59245168cc1a7f6af">zpc_aes_gcm_set_key</a> (struct zpc_aes_gcm *ctx, struct zpc_aes_key *key)</td></tr>
<tr class="separator:a569a6d59a6e7f4f59245168cc1a7f6af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a74be67712e9a06c0f50b761738f158"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#a4a74be67712e9a06c0f50b761738f158">zpc_aes_gcm_set_iv</a> (struct zpc_aes_gcm *ctx, const unsigned char *iv, size_t ivlen)</td></tr>
<tr class="separator:a4a74be67712e9a06c0f50b761738f158"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8698e9bb26b601fb54d0ec176d7d6f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#a3e8698e9bb26b601fb54d0ec176d7d6f">zpc_aes_gcm_encrypt</a> (struct zpc_aes_gcm *ctx, unsigned char *ct, unsigned char *mac, size_t maclen, const unsigned char *aad, size_t aadlen, const unsigned char *pt, size_t ptlen)</td></tr>
<tr class="separator:a3e8698e9bb26b601fb54d0ec176d7d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c492a3fe28b1c74b88cdb2b45b914a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#ab7c492a3fe28b1c74b88cdb2b45b914a">zpc_aes_gcm_decrypt</a> (struct zpc_aes_gcm *ctx, unsigned char *pt, const unsigned char *mac, size_t maclen, const unsigned char *aad, size_t aadlen, const unsigned char *ct, size_t ctlen)</td></tr>
<tr class="separator:ab7c492a3fe28b1c74b88cdb2b45b914a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ef1eaf16de002b45d9d1e66f24db70"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="aes__gcm_8h.html#a55ef1eaf16de002b45d9d1e66f24db70">zpc_aes_gcm_free</a> (struct zpc_aes_gcm **ctx)</td></tr>
<tr class="separator:a55ef1eaf16de002b45d9d1e66f24db70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>AES-GCM API. </p>
<p>Authenticated encryption API for the Advanced Encryption Standard (AES) block cipher <a class="el" href="citelist.html#CITEREF_AES">[1]</a> in Galois/Counter Mode mode of operation <a class="el" href="citelist.html#CITEREF_GCM">[4]</a> .</p>
<p>The context of a AES-GCM operation is stored in objects of type struct zpc_aes_gcm. Context objects must not be shared among multiple threads. Context objects may be used for multiple operations by (re)setting the key or iv. </p>

<p class="definition">Definition in file <a class="el" href="aes__gcm_8h_source.html">aes_gcm.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="aa92ee7ddc9889b2b25b59e761cc294a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa92ee7ddc9889b2b25b59e761cc294a3">&#9670;&nbsp;</a></span>zpc_aes_gcm_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_gcm_alloc </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new context object for an AES-GCM operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a569a6d59a6e7f4f59245168cc1a7f6af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a569a6d59a6e7f4f59245168cc1a7f6af">&#9670;&nbsp;</a></span>zpc_aes_gcm_set_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_gcm_set_key </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct zpc_aes_key *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the key to be used in the context object of an AES-GCM operation.</p>
<p>If a key is already set, the reference count of that key object is decremented. The context's key reference is set to the key object argument. If the key object argument is non-NULL, the reference count of that key object is incremented.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>AES key object </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a4a74be67712e9a06c0f50b761738f158"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a74be67712e9a06c0f50b761738f158">&#9670;&nbsp;</a></span>zpc_aes_gcm_set_iv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_gcm_set_iv </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>iv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ivlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the initialization vector to be used in the context of an AES-GCM operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iv</td><td>initialization vector </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ivlen</td><td>initialization vector length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a3e8698e9bb26b601fb54d0ec176d7d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8698e9bb26b601fb54d0ec176d7d6f">&#9670;&nbsp;</a></span>zpc_aes_gcm_encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_gcm_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aadlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ptlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt a plaintext and sign the ciphertext and additional data using AES-GCM to obtain the corresponding ciphertext and message authentication code. If there is no plaintext input, the operation corresponds to AES-GMAC.</p>
<p>The ciphertext buffer must be large enough to store the resulting ciphertext which has the same length as the plaintext.</p>
<p>Plaintext and ciphertext buffer may be equal such that the operation is done in-place. If the operation is not done in-place, plaintext and ciphertext buffers must not overlap.</p>
<p>Additional data and plaintext may be encrypted and authenticated chunkwise. The additional data must be processed first. All chunk-lengths except the last one must be a multiple of 16 bytes. The plaintext and message authentication code arguments must be NULL when processing those non-final chunks. A chunk-length that is not a multiple of 16 bytes, a non-NULL plaintext argument or a non-NULL message authentication code argument indicate the end of the additional date, The plaintext must be processed second. All chunk-lengths except the last one must be a multiple of 16 bytes. The message autentication code argument must be NULL when processing those non-final chunks. A chunk-length that is not a multiple of 16 bytes or a non-NULL message authentication code argument indicate the end of the plaintext. The same context object must be used to process all chunks without modifying it in between operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ct</td><td>ciphertext buffer </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mac</td><td>message authentication code </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maclen</td><td>message authentication code length [bytes] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aad</td><td>additional authenticated data buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aadlen</td><td>additional authenticated data length [bytes] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pt</td><td>plaintext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptlen</td><td>plaintext length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="ab7c492a3fe28b1c74b88cdb2b45b914a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7c492a3fe28b1c74b88cdb2b45b914a">&#9670;&nbsp;</a></span>zpc_aes_gcm_decrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_aes_gcm_decrypt </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>mac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maclen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aadlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>ctlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt a ciphertext to obtain the corresponding plaintext and verify the message authentication code of the ciphertext and additional data using AES-GCM. If there is no ciphertext input, the operation corresponds to AES-GMAC.</p>
<p>The plaintext buffer must be large enough to store the resulting plaintext which has the same length as the ciphertext.</p>
<p>Plaintext and ciphertext buffer may be equal such that the operation is done in-place. If the operation is not done in-place, plaintext and ciphertext buffers must not overlap.</p>
<p>Additional data and ciphertext may be decrypted and authenticated chunkwise. The additional data must be processed first. All chunk-lengths except the last one must be a multiple of 16 bytes. The ciphertext and message authentication code arguments must be NULL when processing those non-final chunks. A chunk-length that is not a multiple of 16 bytes, a non-NULL ciphertext argument or a non-NULL message authentication code argument indicate the end of the additional date, The ciphertext must be processed second. All chunk-lengths except the last one must be a multiple of 16 bytes. The message autentication code argument must be NULL when processing those non-final chunks. A chunk-length that is not a multiple of 16 bytes or a non-NULL message authentication code argument indicate the end of the ciphertext. The same context object must be used to process all chunks without modifying it in between operations.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pt</td><td>plaintext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mac</td><td>message authentication code buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maclen</td><td>message authentication code length [bytes] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aad</td><td>additional authenticated data buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">aadlen</td><td>additional authenticated data length [bytes] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ct</td><td>ciphertext buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ctlen</td><td>ciphertext length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a55ef1eaf16de002b45d9d1e66f24db70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ef1eaf16de002b45d9d1e66f24db70">&#9670;&nbsp;</a></span>zpc_aes_gcm_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zpc_aes_gcm_free </td>
          <td>(</td>
          <td class="paramtype">struct zpc_aes_gcm **&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free an AES-GCM context object.</p>
<p>If a key is set, the reference count of that key object is decremented. The context object argument is set to NULL.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>AES-GCM context object </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
