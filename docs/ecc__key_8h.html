<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>libzpc: zpc/ecc_key.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">libzpc<span id="projectnumber">&#160;1.4</span>
   </div>
   <div id="projectbrief">IBM Z Protected-key Crypto library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_44f917d4082cd055ef81802047648c24.html">zpc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ecc_key.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>ECC key API.  
<a href="#details">More...</a></p>

<p><a href="ecc__key_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab5234e696a38d33a5aa51599d3a162c3" id="r_ab5234e696a38d33a5aa51599d3a162c3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#ab5234e696a38d33a5aa51599d3a162c3">ZPC_EC_KEY_TYPE_CCA</a>&#160;&#160;&#160;0x1f</td></tr>
<tr class="separator:ab5234e696a38d33a5aa51599d3a162c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a141f79296eb0205d5296a07dec0ad1fd" id="r_a141f79296eb0205d5296a07dec0ad1fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a141f79296eb0205d5296a07dec0ad1fd">ZPC_EC_KEY_TYPE_EP11</a>&#160;&#160;&#160;7</td></tr>
<tr class="separator:a141f79296eb0205d5296a07dec0ad1fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc34de7f2ba45612c1b6ba1d04c156fe" id="r_adc34de7f2ba45612c1b6ba1d04c156fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#adc34de7f2ba45612c1b6ba1d04c156fe">ZPC_EC_KEY_TYPE_PVSECRET</a>&#160;&#160;&#160;9</td></tr>
<tr class="separator:adc34de7f2ba45612c1b6ba1d04c156fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2477c8d57e855d8b0ba8f90a77a90d9d" id="r_a2477c8d57e855d8b0ba8f90a77a90d9d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a2477c8d57e855d8b0ba8f90a77a90d9d">ZPC_EC_KEY_REENCIPHER_OLD_TO_CURRENT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a2477c8d57e855d8b0ba8f90a77a90d9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af57c03891285ec610aa85b55b1ac6700" id="r_af57c03891285ec610aa85b55b1ac6700"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#af57c03891285ec610aa85b55b1ac6700">ZPC_EC_KEY_REENCIPHER_CURRENT_TO_NEW</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:af57c03891285ec610aa85b55b1ac6700"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ad8f6c215298e04018954f1510eee815f" id="r_ad8f6c215298e04018954f1510eee815f"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>zpc_ec_curve_t</b> { <br />
&#160;&#160;<b>ZPC_EC_CURVE_NOT_SET</b> = -2
, <b>ZPC_EC_CURVE_INVALID</b> = -1
, <b>ZPC_EC_CURVE_P256</b> = 0
, <b>ZPC_EC_CURVE_P384</b>
, <br />
&#160;&#160;<b>ZPC_EC_CURVE_P521</b>
, <b>ZPC_EC_CURVE_ED25519</b>
, <b>ZPC_EC_CURVE_ED448</b>
<br />
 }</td></tr>
<tr class="separator:ad8f6c215298e04018954f1510eee815f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac52725e0a6512a3ddf50f84b27516a5" id="r_aac52725e0a6512a3ddf50f84b27516a5"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><b>zpc_ecsecret_type_t</b> { <br />
&#160;&#160;<b>ZPC_EC_SECRET_TYPE_NOT_SET</b> = -2
, <b>ZPC_EC_SECRET_TYPE_INVALID</b> = -1
, <b>ZPC_EC_SECRET_ECDSA_P256</b> = 0x0011
, <b>ZPC_EC_SECRET_ECDSA_P384</b> = 0x0012
, <br />
&#160;&#160;<b>ZPC_EC_SECRET_ECDSA_P521</b> = 0x0013
, <b>ZPC_EC_SECRET_EDDSA_ED25519</b> = 0x0014
, <b>ZPC_EC_SECRET_EDDSA_ED448</b> = 0x0015
<br />
 }</td></tr>
<tr class="separator:aac52725e0a6512a3ddf50f84b27516a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0cc1e11943b227562fc519103f223fa3" id="r_a0cc1e11943b227562fc519103f223fa3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a0cc1e11943b227562fc519103f223fa3">zpc_ec_key_alloc</a> (struct zpc_ec_key **key)</td></tr>
<tr class="separator:a0cc1e11943b227562fc519103f223fa3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87014c50b62560a5f235effe87111a5c" id="r_a87014c50b62560a5f235effe87111a5c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a87014c50b62560a5f235effe87111a5c">zpc_ec_key_set_curve</a> (struct zpc_ec_key *key, zpc_ec_curve_t curve)</td></tr>
<tr class="separator:a87014c50b62560a5f235effe87111a5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4906f850ee547c96f58eac85949e16a8" id="r_a4906f850ee547c96f58eac85949e16a8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a4906f850ee547c96f58eac85949e16a8">zpc_ec_key_set_type</a> (struct zpc_ec_key *key, int type)</td></tr>
<tr class="separator:a4906f850ee547c96f58eac85949e16a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a841dd6681030a18b12c39f2992768385" id="r_a841dd6681030a18b12c39f2992768385"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a841dd6681030a18b12c39f2992768385">zpc_ec_key_set_flags</a> (struct zpc_ec_key *key, unsigned int flags)</td></tr>
<tr class="separator:a841dd6681030a18b12c39f2992768385"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9a5c1dd0c621d3f8f6221b3432c6e0" id="r_a2f9a5c1dd0c621d3f8f6221b3432c6e0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a2f9a5c1dd0c621d3f8f6221b3432c6e0">zpc_ec_key_set_mkvp</a> (struct zpc_ec_key *key, const char *mkvp)</td></tr>
<tr class="separator:a2f9a5c1dd0c621d3f8f6221b3432c6e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594a0dd6d98cefd20eba2a0e16dd3678" id="r_a594a0dd6d98cefd20eba2a0e16dd3678"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a594a0dd6d98cefd20eba2a0e16dd3678">zpc_ec_key_set_apqns</a> (struct zpc_ec_key *key, const char *apqns[])</td></tr>
<tr class="separator:a594a0dd6d98cefd20eba2a0e16dd3678"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade7b0c3ed2429186bd209014a7326033" id="r_ade7b0c3ed2429186bd209014a7326033"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#ade7b0c3ed2429186bd209014a7326033">zpc_ec_key_import</a> (struct zpc_ec_key *key, const unsigned char *seckey, unsigned int seckeylen)</td></tr>
<tr class="separator:ade7b0c3ed2429186bd209014a7326033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43d9bcdcc7962964f7c8d6a8f1636477" id="r_a43d9bcdcc7962964f7c8d6a8f1636477"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a43d9bcdcc7962964f7c8d6a8f1636477">zpc_ec_key_import_clear</a> (struct zpc_ec_key *key, const unsigned char *pubkey, unsigned int publen, const unsigned char *privkey, unsigned int privlen)</td></tr>
<tr class="separator:a43d9bcdcc7962964f7c8d6a8f1636477"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e9998e6713ea9de06ae24c8358c67c6" id="r_a2e9998e6713ea9de06ae24c8358c67c6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a2e9998e6713ea9de06ae24c8358c67c6">zpc_ec_key_export</a> (struct zpc_ec_key *key, unsigned char *seckey, unsigned int *seckeylen)</td></tr>
<tr class="separator:a2e9998e6713ea9de06ae24c8358c67c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad941dd0c1db83e3dfba2e10f687e4868" id="r_ad941dd0c1db83e3dfba2e10f687e4868"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#ad941dd0c1db83e3dfba2e10f687e4868">zpc_ec_key_export_public</a> (struct zpc_ec_key *key, unsigned char *pubkey, unsigned int *pubkeylen)</td></tr>
<tr class="separator:ad941dd0c1db83e3dfba2e10f687e4868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04d1a20e344824b3fae1cf549efd7d23" id="r_a04d1a20e344824b3fae1cf549efd7d23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a04d1a20e344824b3fae1cf549efd7d23">zpc_ec_key_generate</a> (struct zpc_ec_key *key)</td></tr>
<tr class="separator:a04d1a20e344824b3fae1cf549efd7d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf472f598f4e28400e52436905c7fcc6" id="r_adf472f598f4e28400e52436905c7fcc6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#adf472f598f4e28400e52436905c7fcc6">zpc_ec_key_reencipher</a> (struct zpc_ec_key *key, unsigned int reenc)</td></tr>
<tr class="separator:adf472f598f4e28400e52436905c7fcc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a183d8b9354fec874319a005e031c4869" id="r_a183d8b9354fec874319a005e031c4869"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ecc__key_8h.html#a183d8b9354fec874319a005e031c4869">zpc_ec_key_free</a> (struct zpc_ec_key **key)</td></tr>
<tr class="separator:a183d8b9354fec874319a005e031c4869"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ECC key API. </p>
<p>Manage elliptic curve cryptography (ECC) cipher <a class="el" href="citelist.html#CITEREF_EC">[4]</a> keys. </p>

<p class="definition">Definition in file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab5234e696a38d33a5aa51599d3a162c3" name="ab5234e696a38d33a5aa51599d3a162c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5234e696a38d33a5aa51599d3a162c3">&#9670;&#160;</a></span>ZPC_EC_KEY_TYPE_CCA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPC_EC_KEY_TYPE_CCA&#160;&#160;&#160;0x1f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00029">29</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<a id="a141f79296eb0205d5296a07dec0ad1fd" name="a141f79296eb0205d5296a07dec0ad1fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a141f79296eb0205d5296a07dec0ad1fd">&#9670;&#160;</a></span>ZPC_EC_KEY_TYPE_EP11</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPC_EC_KEY_TYPE_EP11&#160;&#160;&#160;7</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00030">30</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<a id="adc34de7f2ba45612c1b6ba1d04c156fe" name="adc34de7f2ba45612c1b6ba1d04c156fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc34de7f2ba45612c1b6ba1d04c156fe">&#9670;&#160;</a></span>ZPC_EC_KEY_TYPE_PVSECRET</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPC_EC_KEY_TYPE_PVSECRET&#160;&#160;&#160;9</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00031">31</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<a id="a2477c8d57e855d8b0ba8f90a77a90d9d" name="a2477c8d57e855d8b0ba8f90a77a90d9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2477c8d57e855d8b0ba8f90a77a90d9d">&#9670;&#160;</a></span>ZPC_EC_KEY_REENCIPHER_OLD_TO_CURRENT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPC_EC_KEY_REENCIPHER_OLD_TO_CURRENT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00034">34</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<a id="af57c03891285ec610aa85b55b1ac6700" name="af57c03891285ec610aa85b55b1ac6700"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af57c03891285ec610aa85b55b1ac6700">&#9670;&#160;</a></span>ZPC_EC_KEY_REENCIPHER_CURRENT_TO_NEW</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZPC_EC_KEY_REENCIPHER_CURRENT_TO_NEW&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00035">35</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ad8f6c215298e04018954f1510eee815f" name="ad8f6c215298e04018954f1510eee815f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8f6c215298e04018954f1510eee815f">&#9670;&#160;</a></span>zpc_ec_curve_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum zpc_ec_curve_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00037">37</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<a id="aac52725e0a6512a3ddf50f84b27516a5" name="aac52725e0a6512a3ddf50f84b27516a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac52725e0a6512a3ddf50f84b27516a5">&#9670;&#160;</a></span>zpc_ecsecret_type_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum zpc_ecsecret_type_t</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ecc__key_8h_source.html#l00047">47</a> of file <a class="el" href="ecc__key_8h_source.html">ecc_key.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a0cc1e11943b227562fc519103f223fa3" name="a0cc1e11943b227562fc519103f223fa3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0cc1e11943b227562fc519103f223fa3">&#9670;&#160;</a></span>zpc_ec_key_alloc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_alloc </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key **&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate a new EC key object with reference count 1. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a87014c50b62560a5f235effe87111a5c" name="a87014c50b62560a5f235effe87111a5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87014c50b62560a5f235effe87111a5c">&#9670;&#160;</a></span>zpc_ec_key_set_curve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_set_curve </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">zpc_ec_curve_t&#160;</td>
          <td class="paramname"><em>curve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the EC curve. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">curve</td><td>EC curve </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a4906f850ee547c96f58eac85949e16a8" name="a4906f850ee547c96f58eac85949e16a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4906f850ee547c96f58eac85949e16a8">&#9670;&#160;</a></span>zpc_ec_key_set_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_set_type </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the EC key type. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>ZPC_EC_KEY_TYPE_CCA or ZPC_EC_KEY_TYPE_EP11 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a841dd6681030a18b12c39f2992768385" name="a841dd6681030a18b12c39f2992768385"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a841dd6681030a18b12c39f2992768385">&#9670;&#160;</a></span>zpc_ec_key_set_flags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_set_flags </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the EC key flags. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>key flags </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a2f9a5c1dd0c621d3f8f6221b3432c6e0" name="a2f9a5c1dd0c621d3f8f6221b3432c6e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9a5c1dd0c621d3f8f6221b3432c6e0">&#9670;&#160;</a></span>zpc_ec_key_set_mkvp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_set_mkvp </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>mkvp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the EC key Master Key Verification Pattern. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mkvp</td><td>master key verification pattern (8 bytes for CCA keys, 16 or 32 bytes for EP11 keys, only the first 16 bytes are relevant). This function has no effect for keys of type PVSECRET. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a594a0dd6d98cefd20eba2a0e16dd3678" name="a594a0dd6d98cefd20eba2a0e16dd3678"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594a0dd6d98cefd20eba2a0e16dd3678">&#9670;&#160;</a></span>zpc_ec_key_set_apqns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_set_apqns </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>apqns</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set the EC key APQNs </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">apqns</td><td>NULL-terminated APQN list This function has no effect for keys of type PVSECRET. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="ade7b0c3ed2429186bd209014a7326033" name="ade7b0c3ed2429186bd209014a7326033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade7b0c3ed2429186bd209014a7326033">&#9670;&#160;</a></span>zpc_ec_key_import()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_import </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>seckeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an EC secure-key. Depending on the key type (CCA or EP11), the secure key buffer must contain either a CCA secure key token or an EP11 secure key structure. For EP11 type keys, a SubjectPublicKeyInfo encoding (SPKI) of the related public EC key may be appended to the secure key data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seckey</td><td>EC secure-key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seckeylen</td><td>EC key secure-length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a43d9bcdcc7962964f7c8d6a8f1636477" name="a43d9bcdcc7962964f7c8d6a8f1636477"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43d9bcdcc7962964f7c8d6a8f1636477">&#9670;&#160;</a></span>zpc_ec_key_import_clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_import_clear </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>publen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>privkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>privlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Import an EC clear-key pair. At least one of the key parts must be non-NULL. A NULL key part leaves a previously set key part untouched, so it is e.g. possible to first import a secure key using the <a class="el" href="ecc__key_8h.html#ade7b0c3ed2429186bd209014a7326033">zpc_ec_key_import()</a> function, and then adding the corresponding public key with a subsequent zpc_ec_import_clear() call. No integrity check is performed on the imported key material, except of a plausibility check on the length of the provided key parts. The application is responsible for providing valid key parts or pairs. Public keys are considered to be the concatenated X and Y values without a leading 0x04 byte that would indicate an uncompressed public key. For PVSECRET type keys it is possible to add the public key to the key object by importing the clear public key. The privkey parm must be NULL and privlen must be 0 when doing this. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pubkey</td><td>an uncompressed EC public key (can be NULL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">publen</td><td>EC public key length [bytes] </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">privkey</td><td>EC private key (can be NULL) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">privlen</td><td>EC private key length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a2e9998e6713ea9de06ae24c8358c67c6" name="a2e9998e6713ea9de06ae24c8358c67c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e9998e6713ea9de06ae24c8358c67c6">&#9670;&#160;</a></span>zpc_ec_key_export()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_export </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>seckey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>seckeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export an EC secure-key. Depending on the key type (CCA or EP11), the secure key is either a CCA secure key token or an EP11 secure key structure. For EP11 type keys, a SubjectPublicKeyInfo encoding (SPKI) of the related public EC key is appended to the secure key data if the key object has a public key.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">seckey</td><td>EC secure-key </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seckeylen</td><td>secure EC secure-key length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="ad941dd0c1db83e3dfba2e10f687e4868" name="ad941dd0c1db83e3dfba2e10f687e4868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad941dd0c1db83e3dfba2e10f687e4868">&#9670;&#160;</a></span>zpc_ec_key_export_public()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_export_public </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pubkey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int *&#160;</td>
          <td class="paramname"><em>pubkeylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Export an EC public-key. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pubkey</td><td>uncompressed EC public-key (can be NULL to obtain the length only) The output buffer contains the concatenated X and Y values of the public key without a leading byte indicating an uncompressed key. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pubkeylen</td><td>EC public-key length [bytes] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a04d1a20e344824b3fae1cf549efd7d23" name="a04d1a20e344824b3fae1cf549efd7d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04d1a20e344824b3fae1cf549efd7d23">&#9670;&#160;</a></span>zpc_ec_key_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_generate </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Generate an EC secure-key. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="adf472f598f4e28400e52436905c7fcc6" name="adf472f598f4e28400e52436905c7fcc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf472f598f4e28400e52436905c7fcc6">&#9670;&#160;</a></span>zpc_ec_key_reencipher()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int zpc_ec_key_reencipher </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>reenc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reencipher an EC secure-key. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">reenc</td><td>ZPC_EC_KEY_REENCIPHER_OLD_TO_CURRENT or ZPC_EC_KEY_REENCIPHER_CURRENT_TO_NEW This function is not applicable for pvsecret-type keys and returns ZPC_ERROR_KEYTYPE when called for such keys. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success. Otherwise, a non-zero error code is returned. </dd></dl>

</div>
</div>
<a id="a183d8b9354fec874319a005e031c4869" name="a183d8b9354fec874319a005e031c4869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a183d8b9354fec874319a005e031c4869">&#9670;&#160;</a></span>zpc_ec_key_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zpc_ec_key_free </td>
          <td>(</td>
          <td class="paramtype">struct zpc_ec_key **&#160;</td>
          <td class="paramname"><em>key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrease the reference count of an EC key object and free it the count reaches 0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">key</td><td>EC key </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
